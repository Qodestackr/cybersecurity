FROM alpine:latest

ENV GOPATH /go
RUN mkdir /go $GOPATH/{bin,src}
ENV PATH $GOPATH/bin:$PATH

WORKDIR /app

RUN apk add --no-cache --update git nodejs npm go
RUN npm install -g grunt-cli
RUN git clone https://github.com/gchq/CyberChef.git cyberchef

WORKDIR /app/cyberchef

RUN npm install
RUN go install -v github.com/projectdiscovery/simplehttpserver/cmd/simplehttpserver@latest
RUN grunt prod

WORKDIR /app/cyberchef/build/prod

CMD [ "simplehttpserver", "-addr", ":8000", "-https"]
